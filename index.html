<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>match fixer by soulz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    	@font-face {
        	font-family: 'lexend';
            src: url(lexend-regular.ttf);
        }
        body {
            background-color: #111;
            font-family: 'lexend';
            color: white;
        }
        .leaderboard {
            background-color: #222;
            padding: 15px;
            border-radius: 5px;
        }
        .table-container {
            max-height: 400px;
            overflow-y: auto;
        }
        .card-header {
            background-color: #222;
            color: white;
        }
        .btn {
            background-color: #222;
            color: white;
        }
        .btn:hover {
            background-color: #333;
        }
        .table {
            background-color: #222;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container my-4">
        <h1 class="text-center">match fixer by soulz</h1>

        <!-- Input Section -->
        <div class="card mb-4">
            <div class="card-header">add participants</div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="participantName" class="form-label">participant name:</label>
                    <input type="text" id="participantName" class="form-control">
                </div>
                <button id="addParticipant" class="btn"> add</button>
                <button id="resetParticipants" class="btn">reset</button>
                <div class="mt-3">
                    <p><strong>participants:</strong></p>
                    <ul id="participantsList" class="list-group"></ul>
                </div>
            </div>
        </div>

        <!-- Fight Match Fixer Section -->
        <div class="card mb-4">
            <div class="card-header">match fixer</div>
            <div class="card-body">
                <button id="generateMatches" class="btn mb-3">set matches</button>
                <button id="reshuffleMatches" class="btn mb-3">reshuffle matches</button>
                <div class="table-container">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>round</th>
                                <th>match</th>
                            </tr>
                        </thead>
                        <tbody id="matchSchedule"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="card mb-4">
            <div class="card-header">match results</div>
            <div class="card-body">
                <div id="resultsSection"></div>
            </div>
        </div>

        <!-- Leaderboard Section -->
        <div class="leaderboard">
            <h2 class="text-center">leaderboard</h2>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>name</th>
                        <th>points</th>
                    </tr>
                </thead>
                <tbody id="leaderboard"></tbody>
            </table>
        </div>
    </div>

    <script>
        const participants = [];
        const matches = [];
        const points = {};

        const addParticipant = () => {
            const name = document.getElementById('participantName').value.trim();
            if (name && !participants.includes(name) && participants.length < 16) {
                participants.push(name);
                points[name] = 0;
                updateParticipantsList();
                document.getElementById('participantName').value = '';
            } else {
                alert('Invalid or duplicate name, or max participants reached.');
            }
        };

        const resetParticipants = () => {
            participants.length = 0;
            matches.length = 0;
            Object.keys(points).forEach(key => delete points[key]);
            updateParticipantsList();
            updateMatchSchedule();
            updateLeaderboard();
        };

        const updateParticipantsList = () => {
            const list = document.getElementById('participantsList');
            list.innerHTML = participants.map(name => `<li class="list-group-item">${name}</li>`).join('');
        };

        const generateMatches = () => {
            if (participants.length % 2 !== 0) {
                alert('Uneven number of participants. Please add one more.');
                return;
            }

            matches.length = 0;
            for (let round = 1; round <= 4; round++) {
                const shuffled = participants.sort(() => Math.random() - 0.5);
                for (let i = 0; i < shuffled.length; i += 2) {
                    matches.push({ round, pair: [shuffled[i], shuffled[i + 1]] });
                }
            }
            updateMatchSchedule();
            updateResultsSection();
        };

        const reshuffleMatches = () => {
            generateMatches();
        };

        const updateMatchSchedule = () => {
            const table = document.getElementById('matchSchedule');
            table.innerHTML = matches.map(match => 
                `<tr><td>Round ${match.round}</td><td>${match.pair[0]} vs ${match.pair[1]}</td></tr>`
            ).join('');
        };

        const updateResultsSection = () => {
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.innerHTML = matches.map((match, index) => 
                `<div class="mb-3">
                    <p><strong>Round ${match.round}:</strong> ${match.pair[0]} vs ${match.pair[1]}</p>
                    <select id="result${index}" class="form-select">
                        <option value="">Select Result</option>
                        <option value="${match.pair[0]}">Winner: ${match.pair[0]}</option>
                        <option value="${match.pair[1]}">Winner: ${match.pair[1]}</option>
                        <option value="draw">Draw</option>
                    </select>
                </div>`
            ).join('');

            resultsSection.insertAdjacentHTML('beforeend', '<button class="btn mt-3" onclick="calculatePoints()">Update Leaderboard</button>');
        };

        const calculatePoints = () => {
            matches.forEach((match, index) => {
                const result = document.getElementById(`result${index}`).value;
                if (result === match.pair[0]) {
                    points[match.pair[0]] += 3;
                    points[match.pair[1]] += 1;
                } else if (result === match.pair[1]) {
                    points[match.pair[1]] += 3;
                    points[match.pair[0]] += 1;
                } else if (result === 'draw') {
                    points[match.pair[0]] += 2;
                    points[match.pair[1]] += 2;
                }
            });
            updateLeaderboard();
        };

        const updateLeaderboard = () => {
            const sorted = Object.entries(points).sort((a, b) => b[1] - a[1]);
            const table = document.getElementById('leaderboard');
            table.innerHTML = sorted.map(([name, point]) => 
                `<tr><td>${name}</td><td>${point}</td></tr>`
            ).join('');
        };

        document.getElementById('addParticipant').addEventListener('click', addParticipant);
        document.getElementById('resetParticipants').addEventListener('click', resetParticipants);
        document.getElementById('generateMatches').addEventListener('click', generateMatches);
        document.getElementById('reshuffleMatches').addEventListener('click', reshuffleMatches);
    </script>
</body>
</html>
